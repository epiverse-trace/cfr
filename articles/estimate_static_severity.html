<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cfr">
<title>Calculating a static, delay-adjusted estimate of disease severity • cfr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating a static, delay-adjusted estimate of disease severity">
<meta property="og:description" content="cfr">
<meta property="og:image" content="https://epiverse-trace.github.io/cfr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cfr</a>

    <small class="nav-text text-muted me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cfr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package vignettes</h6>
    <a class="dropdown-item" href="../articles/estimate_static_severity.html">Calculating a static, delay-adjusted estimate of disease severity</a>
    <a class="dropdown-item" href="../articles/estimate_time_varying_severity.html">Estimating how disease severity varies over the course of an outbreak</a>
    <a class="dropdown-item" href="../articles/estimate_ascertainment.html">Estimating the proportion of cases that are ascertained during an outbreak</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6>
    <a class="dropdown-item" href="../articles/data_from_incidence2.html">Handling data from {incidence2}</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Handling delay distributions</h6>
    <a class="dropdown-item" href="../articles/delay_distributions.html">A primer on working with delay distributions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/cfr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculating a static, delay-adjusted estimate of disease severity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cfr/blob/HEAD/vignettes/estimate_static_severity.Rmd" class="external-link"><code>vignettes/estimate_static_severity.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_static_severity.Rmd</code></div>
    </div>

    
    
<p>Understanding disease severity, and especially the case fatality risk (CFR), is key to outbreak response.
During an outbreak there is often a delay between cases being reported, and the outcomes (for CFR, deaths) of those cases being known, and accounting for these leads to better estimates of CFR.
<code><a href="../reference/cfr_static.html">cfr_static()</a></code> can be used to calculate a static estimate of the severity of an outbreak using methods from <span class="citation">Nishiura et al. (<a href="#ref-nishiura2009" role="doc-biblioref">2009</a>)</span> while accounting for the distribution of reporting delays.</p>
<div class="alert alert-warning">
<p>New to calculating disease severity using <em>cfr</em>? You might want to see the <a href="cfr.html">“Get started” vignette first</a>.</p>
</div>
<div class="section level2 unnumbered alert alert-primary">
<h2 id="use-case">Use case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<p>We want a <strong>static estimate of the severity of an outbreak</strong> in the form of the case fatality risk (CFR) while correcting for the delay in reporting the outcomes of cases.</p>
</div>
<div class="section level3 unnumbered alert alert-secondary">
<h3 id="what-we-have">What we have<a class="anchor" aria-label="anchor" href="#what-we-have"></a>
</h3>
<ul>
<li>A time-series of cases and deaths, (cases may be substituted by another indicator of infections over time);</li>
<li>Data on the distribution of delays, describing the probability an individual will die <span class="math inline">\(t\)</span> days after they were initially infected.</li>
</ul>
</div>
<p>First load <em>cfr</em> and packages to access and plot data.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/cfr" class="external-link">cfr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># packages to wrangle and plot data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="section level2">
<h2 id="severity-of-the-1976-ebola-outbreak">Severity of the 1976 Ebola Outbreak<a class="anchor" aria-label="anchor" href="#severity-of-the-1976-ebola-outbreak"></a>
</h2>
<p>This example data comes from the 1976 Ebola virus disease (EVD, or Ebola) outbreak in the Democratic Republic of the Congo <span class="citation">(<a href="#ref-camacho2014" role="doc-biblioref">Camacho et al. 2014</a>)</span>.</p>
<p>We focus on the roughly the first half of this dataset, by subsetting the data so that we only include days before 30th September, 1976.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ebola1976"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ebola1976</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date cases deaths</span></span>
<span><span class="co">#&gt; 1 1976-08-25     1      0</span></span>
<span><span class="co">#&gt; 2 1976-08-26     0      0</span></span>
<span><span class="co">#&gt; 3 1976-08-27     0      0</span></span>
<span><span class="co">#&gt; 4 1976-08-28     0      0</span></span>
<span><span class="co">#&gt; 5 1976-08-29     0      0</span></span>
<span><span class="co">#&gt; 6 1976-08-30     0      0</span></span>
<span></span>
<span><span class="va">df_ebola_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ebola1976</span>, <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"1976-09-30"</span><span class="op">)</span></span></code></pre></div>
</details><div class="section level3">
<h3 id="onset-to-death-delay-distribution">Onset-to-death delay distribution<a class="anchor" aria-label="anchor" href="#onset-to-death-delay-distribution"></a>
</h3>
<p>We retrieve the parameters of the distribution of durations (also called delays) between the onset of EVD symptoms and death from the literature <span class="citation">(<a href="#ref-barry2018" role="doc-biblioref">Barry et al. 2018</a>)</span>.
This is a Gamma distribution with shape <span class="math inline">\(k\)</span> = 2.40 and scale <span class="math inline">\(\theta\)</span> = 3.33.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> while we shall use a continuous distribution here as we do not expect this difference to bias the estimates excessively, it is more appropriate to use a discretised distribution instead as we are working with daily data.
See the <a href="delay_distribution.html">vignette on delay distributions</a> for more on using discretised distributions with <em>cfr</em>.</p>
<p><strong>Note also</strong> that we use the central estimates for each distribution parameter, and by ignoring uncertainty in these parameters the uncertainty in the resulting CFR is likely to be underestimated.</p>
</div>
</div>
<div class="section level3">
<h3 id="intermediate-step-estimating-expected-deaths">Intermediate step: Estimating expected deaths<a class="anchor" aria-label="anchor" href="#intermediate-step-estimating-expected-deaths"></a>
</h3>
<p>The function <code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> from the <em>cfr</em> package can estimate the number of deaths expected given a time-series of case onset and reported deaths and a delay density function.</p>
<p>The resulting data frame contains two new columns, “estimated_outcomes”, for the number of deaths expected for each day, and “u_t” for the ratio of cumulative number of estimated deaths and the cumulative number of cases reported until each date specified in data.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate known death outcomes</span></span>
<span><span class="va">df_estimated_outcomes_ebola</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_outcomes.html">estimate_outcomes</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_ebola_subset</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">2.40</span>, scale <span class="op">=</span> <span class="fl">3.33</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print head of data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_estimated_outcomes_ebola</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date cases deaths estimated_outcomes        u_t</span></span>
<span><span class="co">#&gt; 1 1976-08-25     1      0         0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; 2 1976-08-26     0      0         0.03323030 0.03323030</span></span>
<span><span class="co">#&gt; 3 1976-08-27     0      0         0.06494676 0.09817706</span></span>
<span><span class="co">#&gt; 4 1976-08-28     0      0         0.08485286 0.18302992</span></span>
<span><span class="co">#&gt; 5 1976-08-29     0      0         0.09400738 0.27703731</span></span>
<span><span class="co">#&gt; 6 1976-08-30     0      0         0.09515185 0.37218916</span></span>
<span></span>
<span><span class="co"># print tail of data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">df_estimated_outcomes_ebola</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date cases deaths estimated_outcomes       u_t</span></span>
<span><span class="co">#&gt; 32 1976-09-25    11      8           7.787856 0.5283224</span></span>
<span><span class="co">#&gt; 33 1976-09-26     7     11           8.301252 0.5563894</span></span>
<span><span class="co">#&gt; 34 1976-09-27     7      7           8.625233 0.5840532</span></span>
<span><span class="co">#&gt; 35 1976-09-28     4     13           8.761617 0.6207698</span></span>
<span><span class="co">#&gt; 36 1976-09-29     4     12           8.659704 0.6552761</span></span>
<span><span class="co">#&gt; 37 1976-09-30     3      9           8.371787 0.6904737</span></span></code></pre></div>
</details><p>The estimated deaths are greater than the true deaths at the beginning of the outbreak, as infected individuals who have not yet died are expected to die in the coming days.</p>
<p>Similarly, the estimated deaths later in the outbreak are similar to or less than the reported deaths, as the deaths of individuals who survived for longer are now reported.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> <code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> is exported but is primarily intended for internal use.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-naive-and-corrected-cfr">Estimating the naive and corrected CFR<a class="anchor" aria-label="anchor" href="#estimating-the-naive-and-corrected-cfr"></a>
</h3>
<p>The function <code><a href="../reference/cfr_static.html">cfr_static()</a></code> wraps the internal functions <code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> and <code><a href="../reference/estimate_severity.html">estimate_severity()</a></code> to provide a static CFR by automatically correcting for reporting delays if a delay density function is provided.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating the naive CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_ebola_subset</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_mean severity_low severity_high</span></span>
<span><span class="co">#&gt; 1     0.7197802    0.6485503     0.7836984</span></span>
<span></span>
<span><span class="co"># calculating the corrected CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_ebola_subset</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">2.40</span>, scale <span class="op">=</span> <span class="fl">3.33</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_mean severity_low severity_high</span></span>
<span><span class="co">#&gt; 1             1        0.868             1</span></span></code></pre></div>
</details>
</div>
</div>
<div class="section level2">
<h2 id="severity-of-the-covid-19-pandemic-in-the-u-k-">Severity of the COVID-19 pandemic in the U.K.<a class="anchor" aria-label="anchor" href="#severity-of-the-covid-19-pandemic-in-the-u-k-"></a>
</h2>
<p>This example shows static severity estimation using <em>cfr</em> and data from the Covid-19 pandemic in the United Kingdom.</p>
<p>We load example Covid-19 daily case and death data provided with the <em>cfr</em> package as <code>covid_data</code>, and subset for the first year of U.K. data.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get Covid data loaded with the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter for the U.K</span></span>
<span><span class="va">df_covid_uk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>  <span class="va">covid_data</span>,</span>
<span>  <span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span>, <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2020-12-31"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first few rows and recall necessary columns: date, cases, deaths</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_covid_uk</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date        country cases deaths</span></span>
<span><span class="co">#&gt; 1 2020-01-03 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 2 2020-01-04 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 3 2020-01-05 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 4 2020-01-06 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 5 2020-01-07 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 6 2020-01-08 United Kingdom     0      0</span></span></code></pre></div>
</details><div class="section level3">
<h3 id="onset-to-death-distribution-for-covid-19">Onset-to-death distribution for Covid-19<a class="anchor" aria-label="anchor" href="#onset-to-death-distribution-for-covid-19"></a>
</h3>
<p>We retrieve the appropriate distribution for Covid-19 from <span class="citation">Linton et al. (<a href="#ref-linton2020" role="doc-biblioref">2020</a>)</span>; this is a lognormal distribution with <span class="math inline">\(\mu\)</span> = 2.577 and <span class="math inline">\(\sigma\)</span> = 0.440.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> <span class="citation">Linton et al. (<a href="#ref-linton2020" role="doc-biblioref">2020</a>)</span> fitted a discretised lognormal distribution and we use a continuous distribution, and that we are ignoring uncertainty in the distribution parameters and likely under-estimating uncertainty in the CFR.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-naive-and-corrected-cfr-1">Estimating the naive and corrected CFR<a class="anchor" aria-label="anchor" href="#estimating-the-naive-and-corrected-cfr-1"></a>
</h3>
<p>Finally, we calculate the naive and corrected CFRs for the Covid-19 pandemic in the U.K.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating the naive CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_covid_uk</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_mean severity_low severity_high</span></span>
<span><span class="co">#&gt; 1    0.03640132   0.03617238     0.0366313</span></span>
<span></span>
<span><span class="co"># calculating the corrected CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_covid_uk</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fl">2.577</span>, sdlog <span class="op">=</span> <span class="fl">0.440</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_mean severity_low severity_high</span></span>
<span><span class="co">#&gt; 1         0.046        0.046         0.047</span></span></code></pre></div>
</details><hr>
</div>
</div>
<div class="section level2">
<h2 id="details-adjusting-for-delays-between-two-time-series">Details: Adjusting for delays between two time series<a class="anchor" aria-label="anchor" href="#details-adjusting-for-delays-between-two-time-series"></a>
</h2>
<p><code><a href="../reference/cfr_static.html">cfr_static()</a></code> follows <span class="citation">Nishiura et al. (<a href="#ref-nishiura2009" role="doc-biblioref">2009</a>)</span> to calculate a quantity <span class="math inline">\(u_t\)</span> for each day within the input data which represents the proportion of cases with a known adverse outcome (usually death) on day <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
  u_t = \dfrac{\sum_{i = 0}^t
        \sum_{j = 0}^\infty c_i f_{j - i}}{\sum_{i = 0} c_i},
\]</span></p>
<p>where <span class="math inline">\(f_t\)</span> is the value of the probability mass function at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(c_t\)</span>, <span class="math inline">\(d_t\)</span> are the number of new cases and new deaths at time <span class="math inline">\(t\)</span> (respectively).
We then use <span class="math inline">\(u_t\)</span> in the following likelihood function to estimate severity.</p>
<p><span class="math display">\[
  {\sf L}(\theta | y) = \log{\dbinom{u_tC}{D}} + D \log{\theta} +
  (u_tC - D)\log{(1.0 - \theta)},
\]</span></p>
<p><span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> are the cumulative number of cases and deaths (respectively) until time <span class="math inline">\(t\)</span>.</p>
<p>Lastly <span class="math inline">\(\theta\)</span> (severity) is estimated <span class="math inline">\(\theta\)</span> using simple maximum-likelihood methods, allowing the functions within this package to be quick and easy tools to use.</p>
<p>The precise severity measure — CFR, IFR, HFR, etc — that <span class="math inline">\(\theta\)</span> represents depends upon the input data given by the user.</p>
<ul>
<li><p>Case fatality risk (CFR) requires case and death incidence data, with a case-to-death delay distribution (or close approximation, such as symptom onset-to-death).</p></li>
<li><p>Infection fatality risk (IFR) requires infection and death incidence data, with an exposure-to-death delay distribution (or close approximation).</p></li>
<li><p>Hospitalisation Fatality Risk (HFR) requires hospitalisation and death incidence data, and the appropriate delay distribution (or close approximation).</p></li>
</ul>
<hr>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-barry2018" class="csl-entry">
Barry, Ahmadou, Steve Ahuka-Mundeke, Yahaya Ali Ahmed, Yokouide Allarangar, Julienne Anoko, Brett Nicholas Archer, Aaron Aruna Abedi, et al. 2018. <span>“Outbreak of Ebola virus disease in the Democratic Republic of the Congo, April–May, 2018: an epidemiological study.”</span> <em>The Lancet</em> 392 (10143): 213–21. <a href="https://doi.org/10.1016/S0140-6736(18)31387-4" class="external-link">https://doi.org/10.1016/S0140-6736(18)31387-4</a>.
</div>
<div id="ref-camacho2014" class="csl-entry">
Camacho, A., A. J. Kucharski, S. Funk, J. Breman, P. Piot, and W. J. Edmunds. 2014. <span>“Potential for Large Outbreaks of Ebola Virus Disease.”</span> <em>Epidemics</em> 9 (December): 70–78. <a href="https://doi.org/10.1016/j.epidem.2014.09.003" class="external-link">https://doi.org/10.1016/j.epidem.2014.09.003</a>.
</div>
<div id="ref-linton2020" class="csl-entry">
Linton, Natalie M., Tetsuro Kobayashi, Yichi Yang, Katsuma Hayashi, Andrei R. Akhmetzhanov, Sung-mok Jung, Baoyin Yuan, Ryo Kinoshita, and Hiroshi Nishiura. 2020. <span>“Incubation Period and Other Epidemiological Characteristics of 2019 Novel Coronavirus Infections with Right Truncation: A Statistical Analysis of Publicly Available Case Data.”</span> <em>Journal of Clinical Medicine</em> 9 (2): 538. <a href="https://doi.org/10.3390/jcm9020538" class="external-link">https://doi.org/10.3390/jcm9020538</a>.
</div>
<div id="ref-nishiura2009" class="csl-entry">
Nishiura, Hiroshi, Don Klinkenberg, Mick Roberts, and Johan A. P. Heesterbeek. 2009. <span>“Early Epidemiological Assessment of the Virulence of Emerging Infectious Diseases: A Case Study of an Influenza Pandemic.”</span> <em>PLOS ONE</em> 4 (8): e6852. <a href="https://doi.org/10.1371/journal.pone.0006852" class="external-link">https://doi.org/10.1371/journal.pone.0006852</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pratik R. Gupte, Adam Kucharski, Tim Russell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
