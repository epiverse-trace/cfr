<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculating a static, delay-adjusted estimate of disease severity • cfr</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating a static, delay-adjusted estimate of disease severity">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cfr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/cfr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_static_severity.html">Calculating a static, delay-adjusted estimate of disease severity</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_time_varying_severity.html">Estimating how disease severity varies over the course of an outbreak</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_ascertainment.html">Estimating the proportion of cases that are ascertained during an outbreak</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6></li>
    <li><a class="dropdown-item" href="../articles/data_from_incidence2.html">Handling data from {incidence2}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling delay distributions</h6></li>
    <li><a class="dropdown-item" href="../articles/delay_distributions.html">A primer on working with delay distributions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Sotware permissions and regulations</h6></li>
    <li><a class="dropdown-item" href="../articles/software-permissions.html">Software permissions and regulations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/cfr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculating a static, delay-adjusted estimate of disease severity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cfr/blob/main/vignettes/estimate_static_severity.Rmd" class="external-link"><code>vignettes/estimate_static_severity.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_static_severity.Rmd</code></div>
    </div>

    
    
<p>Understanding disease severity, and especially the case fatality risk
(CFR), is key to outbreak response. During an outbreak there is often a
delay between cases being reported, and the outcomes (for CFR, deaths)
of those cases being known, and accounting for these leads to better
estimates of CFR. <code><a href="../reference/cfr_static.html">cfr_static()</a></code> can be used to calculate a
static estimate of the severity of an outbreak using methods from <span class="citation">Nishiura et al. (<a href="#ref-nishiura2009">2009</a>)</span> while accounting for the
distribution of reporting delays.</p>
<div class="alert alert-warning">
<p>New to calculating disease severity using <em>cfr</em>? You might
want to see the <a href="cfr.html">“Get started” vignette first</a>.</p>
</div>
<div class="section level2 unnumbered alert alert-primary">
<h2 class="unnumbered" id="use-case">Use case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<p>We want a <strong>static estimate of the severity of an
outbreak</strong> in the form of the case fatality risk (CFR) while
correcting for the delay in reporting the outcomes of cases.</p>
</div>
<div class="section level3 unnumbered alert alert-secondary">
<h3 class="unnumbered" id="what-we-have">What we have<a class="anchor" aria-label="anchor" href="#what-we-have"></a>
</h3>
<ul>
<li>A time-series of cases and deaths, (cases may be substituted by
another indicator of infections over time);</li>
<li>Data on the distribution of delays, describing the probability an
individual will die
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
days after they were initially infected.</li>
</ul>
</div>
<p>First load <em>cfr</em> and packages to access and plot data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/cfr" class="external-link">cfr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># packages to wrangle and plot data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="severity-of-the-1976-ebola-outbreak">Severity of the 1976 Ebola Outbreak<a class="anchor" aria-label="anchor" href="#severity-of-the-1976-ebola-outbreak"></a>
</h2>
<p>This example data comes from the 1976 Ebola virus disease (EVD, or
Ebola) outbreak in the Democratic Republic of the Congo <span class="citation">(<a href="#ref-camacho2014">Camacho et al.
2014</a>)</span>.</p>
<p>We focus on the roughly the first half of this dataset, by subsetting
the data so that we only include days before 30th September, 1976.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ebola1976"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ebola1976</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date cases deaths</span></span>
<span><span class="co">#&gt; 1 1976-08-25     1      0</span></span>
<span><span class="co">#&gt; 2 1976-08-26     0      0</span></span>
<span><span class="co">#&gt; 3 1976-08-27     0      0</span></span>
<span><span class="co">#&gt; 4 1976-08-28     0      0</span></span>
<span><span class="co">#&gt; 5 1976-08-29     0      0</span></span>
<span><span class="co">#&gt; 6 1976-08-30     0      0</span></span>
<span></span>
<span><span class="va">df_ebola_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ebola1976</span>, <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"1976-09-30"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="onset-to-death-delay-distribution">Onset-to-death delay distribution<a class="anchor" aria-label="anchor" href="#onset-to-death-delay-distribution"></a>
</h3>
<p>We retrieve the parameters of the distribution of durations (also
called delays) between the onset of EVD symptoms and death from the
literature <span class="citation">(<a href="#ref-barry2018">Barry et al.
2018</a>)</span>. This is a Gamma distribution with shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= 2.40 and scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
= 3.33.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> while we shall use a continuous
distribution here, it is more appropriate to use a discrete distribution
instead as we are working with daily data. See the <a href="delay_distributions.html">vignette on delay distributions</a> for
more on when using a continuous instead of discrete distribution is
acceptable, and on using discrete distributions with <em>cfr</em>.</p>
<p><strong>Note also</strong> that we use the central estimates for each
distribution parameter, and by ignoring uncertainty in these parameters
the uncertainty in the resulting CFR is likely to be underestimated.</p>
</div>
</div>
<div class="section level3">
<h3 id="intermediate-step-estimating-cases-with-known-outcomes">Intermediate step: Estimating cases with known outcomes<a class="anchor" aria-label="anchor" href="#intermediate-step-estimating-cases-with-known-outcomes"></a>
</h3>
<p>The function <code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> estimates the number of
cases whose outcomes are expected to be known by each day
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
of an outbreak, given a time-series of case onsets and the distribution
of delays between symptom onset and case outcome. In the context of CFR
estimation, the delay distribution is usually an ‘onset-to-death’
distribution.</p>
<p>The resulting data frame contains two new columns,
“estimated_outcomes”, for the number of cases whose outcomes are
expected to be known on each day, and “u_t” for the ratio of cumulative
number of cases estimated to have known outcomes and the cumulative
number of cases reported until each date specified in data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate known death outcomes</span></span>
<span><span class="va">df_estimated_outcomes_ebola</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_outcomes.html">estimate_outcomes</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_ebola_subset</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">2.40</span>, scale <span class="op">=</span> <span class="fl">3.33</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print head of data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_estimated_outcomes_ebola</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date cases deaths estimated_outcomes        u_t</span></span>
<span><span class="co">#&gt; 1 1976-08-25     1      0         0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; 2 1976-08-26     0      0         0.03323030 0.03323030</span></span>
<span><span class="co">#&gt; 3 1976-08-27     0      0         0.06494676 0.09817706</span></span>
<span><span class="co">#&gt; 4 1976-08-28     0      0         0.08485286 0.18302992</span></span>
<span><span class="co">#&gt; 5 1976-08-29     0      0         0.09400738 0.27703731</span></span>
<span><span class="co">#&gt; 6 1976-08-30     0      0         0.09515185 0.37218916</span></span>
<span></span>
<span><span class="co"># print tail of data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">df_estimated_outcomes_ebola</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date cases deaths estimated_outcomes       u_t</span></span>
<span><span class="co">#&gt; 32 1976-09-25    11      8           7.787856 0.5283224</span></span>
<span><span class="co">#&gt; 33 1976-09-26     7     11           8.301252 0.5563894</span></span>
<span><span class="co">#&gt; 34 1976-09-27     7      7           8.625233 0.5840532</span></span>
<span><span class="co">#&gt; 35 1976-09-28     4     13           8.761617 0.6207698</span></span>
<span><span class="co">#&gt; 36 1976-09-29     4     12           8.659704 0.6552761</span></span>
<span><span class="co">#&gt; 37 1976-09-30     3      9           8.371787 0.6904737</span></span></code></pre></div>
<p>The estimated outcomes are lower than the number of cases at the
beginning of an outbreak as the case outcomes are only likely to become
known some days later; this also means that <code>u_t</code> is likely
to be lower than 1.0 early in the outbreak. The <code>u_t</code> for an
outbreak that has ended will be much closer to 1.0, as the outcomes of
all reported cases are expected to be known (depending on the quality of
outbreak monitoring). This depends on the distribution of delays between
onset and outcome, and the ratio <code>u_t</code> will ‘catch up’ to 1.0
faster when the onset-to-outcome delay is short.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> the period between onset and death may be
shorter than the period between onset and full recovery, and should not
be considered equivalent. For CFR estimation, we are primarily
interested in the former as the goal is estimating severity in the form
of a fatality risk (or ratio for past outbreaks).</p>
<p><strong>Note that</strong> <code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> is
exported but is primarily intended for internal use.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-naive-and-corrected-cfr">Estimating the naive and corrected CFR<a class="anchor" aria-label="anchor" href="#estimating-the-naive-and-corrected-cfr"></a>
</h3>
<p>The function <code><a href="../reference/cfr_static.html">cfr_static()</a></code> wraps the internal function
<code><a href="../reference/estimate_outcomes.html">estimate_outcomes()</a></code> to provide a static CFR by
automatically correcting for reporting delays if a delay density
function is provided.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating the naive CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_ebola_subset</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_estimate severity_low severity_high</span></span>
<span><span class="co">#&gt; 1         0.7197802    0.6485503     0.7836984</span></span>
<span></span>
<span><span class="co"># calculating the corrected CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_ebola_subset</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">2.40</span>, scale <span class="op">=</span> <span class="fl">3.33</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_estimate severity_low severity_high</span></span>
<span><span class="co">#&gt; 1                NA           NA            NA</span></span></code></pre></div>
</div>
</div>
<div class="section level2 alert alert-info">
<h2 id="severity-estimation-methods">Severity estimation methods<a class="anchor" aria-label="anchor" href="#severity-estimation-methods"></a>
</h2>
<p><code><a href="../reference/cfr_static.html">cfr_static()</a></code> automatically chooses a method of
calculating the severity estimate, based on whether delay correction is
applied, and further when delay correction is applied, depending on the
total number of cases and an initial rough estimate of the severity.</p>
<ul>
<li><p><strong>Naive estimate</strong>: When delay correction is not
applied, the CFR is the ratio of total deaths to total cases, and the
confidence interval is given by a Binomial test using
<code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">stats::binom.test()</a></code> where total deaths are successes, total
cases are trials, and the hypothesised success is 1.0</p></li>
<li><p><strong>Delay correction, small outbreaks</strong>: For outbreaks
where the total cases are below the user-specified ‘Poisson threshold’
(<code>poisson_threshold</code>, default = 100), the CFR and uncertainty
around it is taken from a profile likelihood generated from a Binomial
model of deaths (successes) and estimated known outcomes
(trials).</p></li>
<li><p><strong>Delay correction, large outbreaks with low
severity</strong>: For outbreaks with total cases greater than the
Poisson threshold (default = 100) and with initial severity estimates
&lt; 0.05, the CFR and uncertainty are taken from a Poisson
approximation of the Binomial profile likelihood (taking
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">np</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
estimated outcomes and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
as the severity estimate).</p></li>
<li><p><strong>Delay correction, large outbreaks with higher
severity</strong>: For outbreaks with total cases greater than the
Poisson threshold (default = 100) and with initial severity estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.05, the CFR and uncertainty are taken from a Normal approximation of
the Binomial profile likelihood.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="severity-of-the-covid-19-pandemic-in-the-u-k-">Severity of the COVID-19 pandemic in the U.K.<a class="anchor" aria-label="anchor" href="#severity-of-the-covid-19-pandemic-in-the-u-k-"></a>
</h2>
<p>This example shows static severity estimation using <em>cfr</em> and
data from the Covid-19 pandemic in the United Kingdom.</p>
<p>We load example Covid-19 daily case and death data provided with the
<em>cfr</em> package as <code>covid_data</code>, and subset for the
first year of U.K. data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get Covid data loaded with the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter for the U.K</span></span>
<span><span class="va">df_covid_uk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>  <span class="va">covid_data</span>,</span>
<span>  <span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span>, <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2020-12-31"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first few rows and recall necessary columns: date, cases, deaths</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_covid_uk</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date        country cases deaths</span></span>
<span><span class="co">#&gt; 1 2020-01-03 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 2 2020-01-04 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 3 2020-01-05 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 4 2020-01-06 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 5 2020-01-07 United Kingdom     0      0</span></span>
<span><span class="co">#&gt; 6 2020-01-08 United Kingdom     0      0</span></span></code></pre></div>
<div class="section level3">
<h3 id="onset-to-death-distribution-for-covid-19">Onset-to-death distribution for Covid-19<a class="anchor" aria-label="anchor" href="#onset-to-death-distribution-for-covid-19"></a>
</h3>
<p>We retrieve the appropriate distribution for Covid-19 from <span class="citation">Linton et al. (<a href="#ref-linton2020">2020</a>)</span>; this is a lognormal
distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
= 2.577 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
= 0.440.</p>
<div class="alert alert-warning">
<p><strong>Note that</strong> <span class="citation">Linton et al. (<a href="#ref-linton2020">2020</a>)</span> fitted a discrete lognormal
distribution and we use a continuous distribution, and that we are
ignoring uncertainty in the distribution parameters and hence likely
under-estimating uncertainty in the CFR.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-naive-and-corrected-cfr-1">Estimating the naive and corrected CFR<a class="anchor" aria-label="anchor" href="#estimating-the-naive-and-corrected-cfr-1"></a>
</h3>
<p>Finally, we calculate the naive and corrected CFRs for the Covid-19
pandemic in the U.K.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating the naive CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_covid_uk</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_estimate severity_low severity_high</span></span>
<span><span class="co">#&gt; 1        0.03640132   0.03617238     0.0366313</span></span>
<span></span>
<span><span class="co"># calculating the corrected CFR</span></span>
<span><span class="fu"><a href="../reference/cfr_static.html">cfr_static</a></span><span class="op">(</span></span>
<span>  <span class="va">df_covid_uk</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fl">2.577</span>, sdlog <span class="op">=</span> <span class="fl">0.440</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   severity_estimate severity_low severity_high</span></span>
<span><span class="co">#&gt; 1            0.0465       0.0462        0.0467</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="details-adjusting-for-delays-between-two-time-series">Details: Adjusting for delays between two time series<a class="anchor" aria-label="anchor" href="#details-adjusting-for-delays-between-two-time-series"></a>
</h2>
<p><code><a href="../reference/cfr_static.html">cfr_static()</a></code> follows <span class="citation">Nishiura et
al. (<a href="#ref-nishiura2009">2009</a>)</span> to calculate a
quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>t</mi></msub><annotation encoding="application/x-tex">u_t</annotation></semantics></math>
for each day within the input data which represents the proportion of
cases with a known adverse outcome (usually death) on day
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mfrac displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>t</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mo accent="false">∞</mo></munderover><msub><mi>c</mi><mrow><mi>i</mi><mo>−</mo><mi>j</mi></mrow></msub><msub><mi>f</mi><mi>j</mi></msub></mrow><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow></munder><msub><mi>c</mi><mi>i</mi></msub></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
  u_t = \dfrac{\sum_{i = 0}^t
        \sum_{j = 0}^\infty c_{i - j} f_{j}}{\sum_{i = 0} c_i},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>t</mi></msub><annotation encoding="application/x-tex">f_t</annotation></semantics></math>
is the value of the probability mass function at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>t</mi></msub><annotation encoding="application/x-tex">c_t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>t</mi></msub><annotation encoding="application/x-tex">d_t</annotation></semantics></math>
are the number of new cases and new deaths at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(respectively). We then use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>t</mi></msub><annotation encoding="application/x-tex">u_t</annotation></semantics></math>
in the following likelihood function to estimate severity.</p>
<p><span class="math display">$$
  {\sf L}(\theta | C_{t},D_{t},u_{t}) = \log{\dbinom{u_{t}C_{t}}{D_{t}}}
+ D_{t} \log{\theta} +
  (u_{t}C_{t} - D_{t})\log{(1 - \theta)},
$$</span></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>t</mi></msub><annotation encoding="application/x-tex">C_{t}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math>
are the cumulative number of cases and deaths (respectively) until time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p>Lastly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
(severity) is estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
using simple maximum-likelihood methods, allowing the functions within
this package to be quick and easy tools to use.</p>
<p>The precise severity measure — CFR, IFR, HFR, etc — that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
represents depends upon the input data given by the user.</p>
<ul>
<li><p>Case fatality risk (CFR) requires case and death incidence data,
with a case-to-death delay distribution (or close approximation, such as
symptom onset-to-death).</p></li>
<li><p>Infection fatality risk (IFR) requires infection and death
incidence data, with an exposure-to-death delay distribution (or close
approximation).</p></li>
<li><p>Hospitalisation Fatality Risk (HFR) requires hospitalisation and
death incidence data, and the appropriate delay distribution (or close
approximation).</p></li>
</ul>
<hr>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-barry2018" class="csl-entry">
Barry, Ahmadou, Steve Ahuka-Mundeke, Yahaya Ali Ahmed, Yokouide
Allarangar, Julienne Anoko, Brett Nicholas Archer, Aaron Aruna Abedi, et
al. 2018. <span>“Outbreak of Ebola virus disease in the Democratic
Republic of the Congo, April–May, 2018: an epidemiological
study.”</span> <em>The Lancet</em> 392 (10143): 213–21. <a href="https://doi.org/10.1016/S0140-6736(18)31387-4" class="external-link">https://doi.org/10.1016/S0140-6736(18)31387-4</a>.
</div>
<div id="ref-camacho2014" class="csl-entry">
Camacho, A., A. J. Kucharski, S. Funk, J. Breman, P. Piot, and W. J.
Edmunds. 2014. <span>“Potential for Large Outbreaks of Ebola Virus
Disease.”</span> <em>Epidemics</em> 9 (December): 70–78. <a href="https://doi.org/10.1016/j.epidem.2014.09.003" class="external-link">https://doi.org/10.1016/j.epidem.2014.09.003</a>.
</div>
<div id="ref-linton2020" class="csl-entry">
Linton, Natalie M., Tetsuro Kobayashi, Yichi Yang, Katsuma Hayashi,
Andrei R. Akhmetzhanov, Sung-mok Jung, Baoyin Yuan, Ryo Kinoshita, and
Hiroshi Nishiura. 2020. <span>“Incubation Period and Other
Epidemiological Characteristics of 2019 Novel Coronavirus Infections
with Right Truncation: A Statistical Analysis of Publicly Available Case
Data.”</span> <em>Journal of Clinical Medicine</em> 9 (2): 538. <a href="https://doi.org/10.3390/jcm9020538" class="external-link">https://doi.org/10.3390/jcm9020538</a>.
</div>
<div id="ref-nishiura2009" class="csl-entry">
Nishiura, Hiroshi, Don Klinkenberg, Mick Roberts, and Johan A. P.
Heesterbeek. 2009. <span>“Early Epidemiological Assessment of the
Virulence of Emerging Infectious Diseases: A Case Study of an Influenza
Pandemic.”</span> <em>PLOS ONE</em> 4 (8): e6852. <a href="https://doi.org/10.1371/journal.pone.0006852" class="external-link">https://doi.org/10.1371/journal.pone.0006852</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik R. Gupte, Adam Kucharski, Tim Russell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
