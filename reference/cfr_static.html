<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate a static disease severity measure — cfr_static • cfr</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a static disease severity measure — cfr_static"><meta name="description" content="Calculates the severity of a disease, while optionally
correcting for reporting delays using an epidemiological delay distribution
of the time between symptom onset and death (onset-to-death).
Other delay distributions may be passed to calculate different disease
severity measures such as the hospitalisation fatality risk."><meta property="og:description" content="Calculates the severity of a disease, while optionally
correcting for reporting delays using an epidemiological delay distribution
of the time between symptom onset and death (onset-to-death).
Other delay distributions may be passed to calculate different disease
severity measures such as the hospitalisation fatality risk."><meta property="og:image" content="https://epiverse-trace.github.io/cfr/logo.svg"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cfr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cfr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_static_severity.html">Calculating a static, delay-adjusted estimate of disease severity</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_time_varying_severity.html">Estimating how disease severity varies over the course of an outbreak</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_ascertainment.html">Estimating the proportion of cases that are ascertained during an outbreak</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_from_individual_data.html">Estimating fatality risk from individual level data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6></li>
    <li><a class="dropdown-item" href="../articles/data_from_incidence2.html">Handling data from {incidence2}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling delay distributions</h6></li>
    <li><a class="dropdown-item" href="../articles/delay_distributions.html">A primer on working with delay distributions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Sotware permissions and regulations</h6></li>
    <li><a class="dropdown-item" href="../articles/software-permissions.html">Software permissions and regulations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/cfr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate a static disease severity measure</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cfr/blob/main/R/cfr_static.R" class="external-link"><code>R/cfr_static.R</code></a></small>
      <div class="d-none name"><code>cfr_static.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the severity of a disease, while optionally
correcting for reporting delays using an epidemiological delay distribution
of the time between symptom onset and death (onset-to-death).</p>
<p>Other delay distributions may be passed to calculate different disease
severity measures such as the hospitalisation fatality risk.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cfr_static</span><span class="op">(</span><span class="va">data</span>, delay_density <span class="op">=</span> <span class="cn">NULL</span>, poisson_threshold <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>&lt;data.frame&gt;</code> containing the outbreak data. A daily time
series with dates or some other absolute indicator of time (e.g. epiday or
epiweek) and the numbers of new cases and new deaths at each time point.
Note that the required columns are "date" (for the date), "cases" (for the
number of reported cases), and "deaths" (for the number of reported deaths)
on each day of the outbreak.</p>
<p>Note that the <code>&lt;data.frame&gt;</code> is required to have an unbroken sequence of
dates with no missing dates in between. The "date" column must be of class
<code>Date</code> (see <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>).</p>
<p>Note also that the total number of cases must be greater than the total
number of reported deaths.</p></dd>


<dt id="arg-delay-density">delay_density<a class="anchor" aria-label="anchor" href="#arg-delay-density"></a></dt>
<dd><p>An optional argument that controls whether delay
correction is applied in the severity estimation.
May be <code>NULL</code>, for no delay correction, or a function that returns the
density function of a distribution to evaluate
density at user-specified values, e.g.
<code>function(x) stats::dgamma(x = x, shape = 5, scale = 1)</code>.</p></dd>


<dt id="arg-poisson-threshold">poisson_threshold<a class="anchor" aria-label="anchor" href="#arg-poisson-threshold"></a></dt>
<dd><p>The case count above which to use Poisson
approximation. Set to 100 by default. Must be &gt; 0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>&lt;data.frame&gt;</code> with the maximum likelihood estimate and 95%
confidence interval of the severity estimates, named "severity_estimate",
"severity_low", and "severity_high".</p>
    </div>
    <div class="section level2">
    <h2 id="details-adjusting-for-delays-between-two-time-series">Details: Adjusting for delays between two time series<a class="anchor" aria-label="anchor" href="#details-adjusting-for-delays-between-two-time-series"></a></h2>
    <p>The method used in <code>cfr_static()</code> follows Nishiura et al.
(2009).
The function calculates a quantity \(u_t\) for each day within the input
data, which represents the proportion of cases estimated to have
a known outcome on day \(t\).
Following Nishiura et al., \(u_t\) is calculated as:
$$u_t = \dfrac{\sum_{i = 0}^t
        \sum_{j = 0}^\infty c_i f_{j - i}}{\sum_{i = 0} c_i}$$
where \(f_t\) is the value of the probability mass function at time \(t\)
and \(c_t\), \(d_t\) are the number of new cases and new deaths at time
\(t\), (respectively).
We then use \(u_t\) at the end of the outbreak in the following likelihood
function to estimate the severity of the disease in question.
$${\sf L}({\theta \mid y}) = \log{\dbinom{u_tC}{D}} + D \log{\theta} +
  (u_tC - D)\log{(1.0 - \theta)}$$
\(C\) and \(D\) are the cumulative number of cases and deaths
(respectively) up until time \(t\).
\(\theta\) is the parameter we wish to estimate, the severity of the
disease. We estimate \(\theta\) using simple maximum-likelihood methods,
allowing the functions within this package to be quick and easy tools to use.</p>
<p>The precise severity measure — CFR, IFR, HFR, etc — that \(\theta\)
represents depends upon the input data given by the user.</p>
<p>The epidemiological delay-distribution density function passed to
<code>delay_density</code> is used to evaluate the probability mass function
parameterised by time; i.e. \(f(t)\) which
gives the probability that a case has a known outcome (usually death) at time
\(t\), parameterised with disease-specific parameters before it is supplied
here.</p><div class="section">
<h3 id="profile-likelihood-methods">Profile likelihood methods<a class="anchor" aria-label="anchor" href="#profile-likelihood-methods"></a></h3>


<p>The naive CFR estimate (without delay correction) is the outcome of a
Binomial test on deaths and cases using <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">stats::binom.test()</a></code>.
The confidence intervals around the estimate are also taken from the test.</p>
<p>The delay-corrected CFR estimates are however obtained by generating a
profile likelihood over the sequence <code>seq(1e-4, 1.0, 1e-4)</code>. The method used
depends on the outbreak size and the initial expectation of disease severity.
This is implemented in the internal function <code><a href="dot-estimate_severity.html">.estimate_severity()</a></code>.</p><ul><li><p><strong>Delay correction, small outbreaks</strong>: For outbreaks where the total cases
are below the user-specified 'Poisson threshold' (<code>poisson_threshold</code>,
default = 100), the CFR and uncertainty around it is taken from a profile
likelihood generated from a Binomial model of deaths (successes) and
estimated known outcomes (trials).</p><ul><li><p><strong>Delay correction, large outbreaks with low severity</strong>: For outbreaks
with total cases greater than the Poisson threshold (default = 100) and with
initial severity estimates &lt; 0.05, the CFR and uncertainty are taken from a
Poisson approximation of the Binomial profile likelihood (taking
\(\lambda = np\) for \(n\) estimated outcomes and \(p\) as the severity
estimate).</p></li>
</ul></li>
<li><p><strong>Delay correction, large outbreaks with higher severity</strong>: For outbreaks
with total cases greater than the Poisson threshold (default = 100) and with
initial severity estimates \(\geq\) 0.05, the CFR and uncertainty are taken
from a Normal approximation of the Binomial profile likelihood.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nishiura, H., Klinkenberg, D., Roberts, M., &amp; Heesterbeek, J. A. P. (2009).
Early Epidemiological Assessment of the Virulence of Emerging Infectious
Diseases: A Case Study of an Influenza Pandemic. PLOS ONE, 4(8), e6852.
<a href="https://doi.org/10.1371/journal.pone.0006852" class="external-link">doi:10.1371/journal.pone.0006852</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load package data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ebola1976"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate severity without correcting for delays</span></span></span>
<span class="r-in"><span><span class="fu">cfr_static</span><span class="op">(</span><span class="va">ebola1976</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   severity_estimate severity_low severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          0.955102    0.9210866     0.9773771</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate severity for each day while correcting for delays</span></span></span>
<span class="r-in"><span><span class="co"># obtain onset-to-death delay distribution parameters from Barry et al. 2018</span></span></span>
<span class="r-in"><span><span class="co"># The Lancet. &lt;https://doi.org/10.1016/S0140-6736(18)31387-4&gt;</span></span></span>
<span class="r-in"><span><span class="fu">cfr_static</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ebola1976</span>,</span></span>
<span class="r-in"><span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">2.40</span>, scale <span class="op">=</span> <span class="fl">3.33</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   severity_estimate severity_low severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0.9592       0.9295        0.9793</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik R. Gupte, Adam Kucharski, Tim Russell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

