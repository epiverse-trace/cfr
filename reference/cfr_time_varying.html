<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates how the severity of a disease changes over time
while optionally correcting for reporting delays using an epidemiological
delay distribution of the time between symptom onset and death
(onset-to-death)."><title>Estimate a severity measure that varies over time — cfr_time_varying • cfr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a severity measure that varies over time — cfr_time_varying"><meta property="og:description" content="Calculates how the severity of a disease changes over time
while optionally correcting for reporting delays using an epidemiological
delay distribution of the time between symptom onset and death
(onset-to-death)."><meta property="og:image" content="https://epiverse-trace.github.io/cfr/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cfr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/cfr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package vignettes</h6>
    <a class="dropdown-item" href="../articles/estimate_static_severity.html">Calculating a static, delay-adjusted estimate of disease severity</a>
    <a class="dropdown-item" href="../articles/estimate_time_varying_severity.html">Estimating how disease severity varies over the course of an outbreak</a>
    <a class="dropdown-item" href="../articles/estimate_ascertainment.html">Estimating the proportion of cases that are ascertained during an outbreak</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6>
    <a class="dropdown-item" href="../articles/data_from_incidence2.html">Handling data from {incidence2}</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/cfr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate a severity measure that varies over time</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cfr/blob/HEAD/R/estimate_time_varying.R" class="external-link"><code>R/estimate_time_varying.R</code></a></small>
      <div class="d-none name"><code>cfr_time_varying.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates how the severity of a disease changes over time
while optionally correcting for reporting delays using an epidemiological
delay distribution of the time between symptom onset and death
(onset-to-death).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cfr_time_varying</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  epidist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fu"><a href="get_default_burn_in.html">get_default_burn_in</a></span><span class="op">(</span><span class="va">epidist</span><span class="op">)</span>,</span>
<span>  smoothing_window <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A <code>&lt;data.frame&gt;</code> containing the outbreak data. A daily time
series with dates or some other absolute indicator of time (e.g. epiday or
epiweek) and the numbers of new cases and new deaths at each time point.
Note that the required columns are "date" (for the date), "cases" (for the
number of reported cases), and "deaths" (for the number of reported deaths)
on each day of the outbreak.</p>
<p>Note that the <code>&lt;data.frame&gt;</code> is required to have an unbroken sequence of
dates with no missing dates in between. The "date" column must be of class
<code>Date</code> (see <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>).</p>
<p>Note also that the total number of cases must be greater than the total
number of reported deaths.</p></dd>


<dt>epidist</dt>
<dd><p>An optional argument for the delay distribution used, in the
form of an <code>&lt;epidist&gt;</code> object.
Defaults to <code>NULL</code>, in which case no delay correction is applied.
Passing an <code>&lt;epidist&gt;</code> automatically applies delay correction in the
severity estimation.</p></dd>


<dt>burn_in</dt>
<dd><p>A single integer value for the number of time-points
(typically days) to disregard at the start of the time-series, if a burn-in
period is desired.</p>
<p>When an <code>&lt;epidist&gt;</code> is provided and delay correction is requested, the
default value is set to the mean of the <code>&lt;epidist&gt;</code>.</p>
<p>Defaults to 7 if no <code>&lt;epidist&gt;</code> is provided, or if the <code>&lt;epidist&gt;</code> is not
parameterised. This is a sensible default value that disregards the first
week of cases and deaths, assuming daily data.</p>
<p>To consider all case data including the start of the time-series, set this
argument to 0.</p></dd>


<dt>smoothing_window</dt>
<dd><p>An <em>odd</em> number determining the smoothing window size
to use when smoothing the case and death time-series, using a rolling median
procedure (as the <code>k</code> argument to <code><a href="https://rdrr.io/r/stats/runmed.html" class="external-link">stats::runmed()</a></code>) before calculating the
time-varying severity.</p>
<p>The default behaviour is to apply no smoothing. The minimum value of this
argument is 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>&lt;data.frame&gt;</code> containing the maximum likelihood estimate estimate
and 95% confidence interval of the corrected severity.</p>
    </div>
    <div class="section level2">
    <h2 id="details-adjusting-for-delays-between-two-time-series">Details: Adjusting for delays between two time series<a class="anchor" aria-label="anchor" href="#details-adjusting-for-delays-between-two-time-series"></a></h2>
    <p>This function estimates the number of cases which have a known outcome over
time, following Nishiura et al. (2009).
The function calculates a quantity \(k_t\) for each day within the input
data, which represents the number of cases with a known outcome, on day
\(t\). \(k_t\) is calculated in the following way:
$$k_t = \sum_{j = 0}^t c_t f_{j - t}$$</p>
<p>We then assume that the severity measure, for example CFR, of interest is
binomially distributed, in the following way:</p>
<p>$$d_t \sim {\sf Binomial}(k_t, \theta_t)$$</p>
<p>We use maximum likelihood estimation to determine the value of \(\theta_t\)
for each \(t\), where \(\theta\) represents the severity measure of
interest.</p>
<p>The epidemiological delay distribution passed to <code>epidist</code> is used to obtain
a probability mass function parameterised by time; i.e. \(f(t)\) which
gives the probability a case has a known outcomes (usually, death) at time
\(t\), parameterised with disease-specific parameters before it is supplied
here.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nishiura, H., Klinkenberg, D., Roberts, M., &amp; Heesterbeek, J. A. P. (2009).
Early Epidemiological Assessment of the Virulence of Emerging Infectious
Diseases: A Case Study of an Influenza Pandemic. PLOS ONE, 4(8), e6852.
<a href="https://doi.org/10.1371/journal.pone.0006852" class="external-link">doi:10.1371/journal.pone.0006852</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># get data pre-loaded with the package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_covid_uk</span> <span class="op">&lt;-</span> <span class="va">covid_data</span><span class="op">[</span><span class="va">covid_data</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load epidist object from {epiparameter}</span></span></span>
<span class="r-in"><span><span class="va">onset_to_death_covid</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epidist_db.html" class="external-link">epidist_db</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  disease <span class="op">=</span> <span class="st">"COVID-19"</span>,</span></span>
<span class="r-in"><span>  epi_dist <span class="op">=</span> <span class="st">"onset_to_death"</span>,</span></span>
<span class="r-in"><span>  author <span class="op">=</span> <span class="st">"Linton_etal"</span>,</span></span>
<span class="r-in"><span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using list(author = list(list(given = NULL, family = "Linton", role = NULL, email = NULL, comment = NULL), list(given = NULL, family = "etal", role = NULL, email = NULL, comment = NULL)), year = "2020", title = "Incubation Period and Other Epidemiological Characteristics of 2019 Novel Coronavirus Infections with Right Truncation: A Statistical Analysis of Publicly Available Case Data", journal = "Journal of Clinical Medicine", doi = "10.3390/jcm9020538", pmid = "32079150"). </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To retrieve the short citation use the 'get_citation' function</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate time varying severity without correcting for delays</span></span></span>
<span class="r-in"><span><span class="va">cfr_time_varying</span> <span class="op">&lt;-</span> <span class="fu">cfr_time_varying</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_covid_uk</span>,</span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">7L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># View</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">cfr_time_varying</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             date        country cases deaths severity_mean severity_low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20690 2022-12-26 United Kingdom  4132    144    0.03484995   0.02946797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20709 2022-12-27 United Kingdom  3694    131    0.03546291   0.02973354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20728 2022-12-28 United Kingdom  4950    128    0.02585859   0.02161760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20747 2022-12-29 United Kingdom  6605    142    0.02149886   0.01813784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20766 2022-12-30 United Kingdom  8419    134    0.01591638   0.01335220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20785 2022-12-31 United Kingdom  7718    132    0.01710288   0.01432899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20690    0.04090181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20709    0.04194157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20728    0.03067046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20747    0.02529105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20766    0.01882303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20785    0.02024949</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate time varying severity while correcting for delays</span></span></span>
<span class="r-in"><span><span class="va">cfr_time_varying</span> <span class="op">&lt;-</span> <span class="fu">cfr_time_varying</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_covid_uk</span>,</span></span>
<span class="r-in"><span>  epidist <span class="op">=</span> <span class="va">onset_to_death_covid</span>,</span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">7L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">cfr_time_varying</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             date        country cases deaths severity_mean severity_low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20690 2022-12-26 United Kingdom  4132    144    0.03471553   0.02935401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20709 2022-12-27 United Kingdom  3694    131    0.03065762   0.02569476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20728 2022-12-28 United Kingdom  4950    128    0.02893963   0.02419931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20747 2022-12-29 United Kingdom  6605    142    0.03093008   0.02611344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20766 2022-12-30 United Kingdom  8419    134    0.02815718   0.02364360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20785 2022-12-31 United Kingdom  7718    132    0.02684018   0.02250428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20690    0.04074453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20709    0.03627492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20728    0.03431472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20747    0.03635481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20766    0.03326130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20785    0.03174924</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pratik Gupte, Adam Kucharski, Tim Russell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

