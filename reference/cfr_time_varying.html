<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate a severity measure that varies over time — cfr_time_varying • cfr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a severity measure that varies over time — cfr_time_varying"><meta property="og:description" content="Calculates how the severity of a disease changes over time
while optionally correcting for reporting delays using an epidemiological
delay distribution of the time between symptom onset and outcome
(e.g. onset-to-death for the fatality risk)."><meta property="og:image" content="https://epiverse-trace.github.io/cfr/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><nav class="navbar fixed-top navbar-default navbar-expand-lg bg-"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cfr</a>

    <small class="nav-text text-default me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li>
  <a href="../articles/cfr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Package vignettes</li>
    <li>
      <a href="../articles/estimate_static_severity.html">Calculating a static, delay-adjusted estimate of disease severity</a>
    </li>
    <li>
      <a href="../articles/estimate_time_varying_severity.html">Estimating how disease severity varies over the course of an outbreak</a>
    </li>
    <li>
      <a href="../articles/estimate_ascertainment.html">Estimating the proportion of cases that are ascertained during an outbreak</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Handling data from other packages</li>
    <li>
      <a href="../articles/data_from_incidence2.html">Handling data from {incidence2}</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Handling delay distributions</li>
    <li>
      <a href="../articles/delay_distributions.html">A primer on working with delay distributions</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Sotware permissions and regulations</li>
    <li>
      <a href="../articles/software-permissions.html">Software permissions and regulations</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li>
  <a href="https://github.com/epiverse-trace/cfr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav></header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate a severity measure that varies over time</h1>
    <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cfr/blob/HEAD/R/cfr_time_varying.R" class="external-link"><code>R/cfr_time_varying.R</code></a></small>
    <div class="hidden name"><code>cfr_time_varying.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates how the severity of a disease changes over time
while optionally correcting for reporting delays using an epidemiological
delay distribution of the time between symptom onset and outcome
(e.g. onset-to-death for the fatality risk).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cfr_time_varying</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  delay_density <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  smoothing_window <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A <code>&lt;data.frame&gt;</code> containing the outbreak data. A daily time
series with dates or some other absolute indicator of time (e.g. epiday or
epiweek) and the numbers of new cases and new deaths at each time point.
Note that the required columns are "date" (for the date), "cases" (for the
number of reported cases), and "deaths" (for the number of reported deaths)
on each day of the outbreak.</p>
<p>Note that the <code>&lt;data.frame&gt;</code> is required to have an unbroken sequence of
dates with no missing dates in between. The "date" column must be of class
<code>Date</code> (see <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>).</p>
<p>Note also that the total number of cases must be greater than the total
number of reported deaths.</p></dd>


<dt>delay_density</dt>
<dd><p>An optional argument that controls whether delay
correction is applied in the severity estimation.
May be <code>NULL</code>, for no delay correction, or a function that returns the
density function of a distribution to evaluate
density at user-specified values, e.g.
<code>function(x) stats::dgamma(x = x, shape = 5, scale = 1)</code>.</p></dd>


<dt>burn_in</dt>
<dd><p>A single integer-like value for the number of time-points
(typically days) to disregard at the start of the time-series, if a burn-in
period is desired.</p>
<p>Defaults to 7, which is a sensible default value that disregards the first
week of cases and deaths, assuming daily data.</p>
<p>To consider all case data including the start of the time-series, set this
argument to 0.</p></dd>


<dt>smoothing_window</dt>
<dd><p>An <em>odd</em> number determining the smoothing window size
to use when smoothing the case and death time-series, using a rolling median
procedure (as the <code>k</code> argument to <code><a href="https://rdrr.io/r/stats/runmed.html" class="external-link">stats::runmed()</a></code>) before calculating the
time-varying severity.</p>
<p>The default behaviour is to apply no smoothing. The minimum value of this
argument is 1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>&lt;data.frame&gt;</code> with the date, maximum likelihood estimate and 95%
confidence interval of the daily severity estimates, named
"severity_mean", "severity_low", and "severity_high", with one row for each
day in the original data.frame.</p>
    </div>
    <div id="details-adjusting-for-delays-between-two-time-series">
    <h2>Details: Adjusting for delays between two time series</h2>
    <p>This function estimates the number of cases which have a known outcome over
time, following Nishiura et al. (2009).
The function calculates a quantity \(k_t\) for each day within the input
data, which represents the number of cases estimated to have a known outcome,
on day \(t\). \(k_t\) is calculated in the following way:
$$k_t = \sum_{j = 0}^t c_t f_{j - t}$$</p>
<p>We then assume that the severity measure, for example CFR, of interest is
binomially distributed, in the following way:</p>
<p>$$d_t \sim {\sf Binomial}(k_t, \theta_t)$$</p>
<p>We use maximum likelihood estimation to determine the value of \(\theta_t\)
for each \(t\), where \(\theta\) represents the severity measure of
interest.</p>
<p>The epidemiological delay distribution passed to <code>delay_density</code> is used to
obtain a probability mass function parameterised by time; i.e. \(f(t)\)
which gives the probability a case has a known outcomes (usually, death) at
time \(t\), parameterised with disease-specific parameters before it is
supplied here.</p>
<p><strong>Note</strong> that the function arguments <code>burn_in</code> and <code>smoothing_window</code> are not
explicitly used in this calculation. <code>burn_in</code> controls how many estimates at
the beginning of the outbreak are replaced with <code>NA</code>s --- the calculation
above is not applied to the first <code>burn_in</code> data points.
The calculation is applied to the smoothed data, if a <code>smoothing_window</code>
is specified.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Nishiura, H., Klinkenberg, D., Roberts, M., &amp; Heesterbeek, J. A. P. (2009).
Early Epidemiological Assessment of the Virulence of Emerging Infectious
Diseases: A Case Study of an Influenza Pandemic. PLOS ONE, 4(8), e6852.
<a href="https://doi.org/10.1371/journal.pone.0006852" class="external-link">doi:10.1371/journal.pone.0006852</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># get data pre-loaded with the package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_covid_uk</span> <span class="op">&lt;-</span> <span class="va">covid_data</span><span class="op">[</span><span class="va">covid_data</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate time varying severity without correcting for delays</span></span></span>
<span class="r-in"><span><span class="va">cfr_time_varying</span> <span class="op">&lt;-</span> <span class="fu">cfr_time_varying</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_covid_uk</span>,</span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">7L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># View</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">cfr_time_varying</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            date severity_mean severity_low severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1089 2022-12-26    0.03484995   0.02946797    0.04090181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1090 2022-12-27    0.03546291   0.02973354    0.04194157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1091 2022-12-28    0.02585859   0.02161760    0.03067046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1092 2022-12-29    0.02149886   0.01813784    0.02529105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1093 2022-12-30    0.01591638   0.01335220    0.01882303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1094 2022-12-31    0.01710288   0.01432899    0.02024949</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate time varying severity while correcting for delays</span></span></span>
<span class="r-in"><span><span class="co"># obtain onset-to-death delay distribution parameters from Linton et al. 2020</span></span></span>
<span class="r-in"><span><span class="co"># J. Clinical Medicine: &lt;https://doi.org/10.3390/jcm9020538&gt;</span></span></span>
<span class="r-in"><span><span class="co"># view only the first values</span></span></span>
<span class="r-in"><span><span class="va">cfr_time_varying</span> <span class="op">&lt;-</span> <span class="fu">cfr_time_varying</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_covid_uk</span>,</span></span>
<span class="r-in"><span>  delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fl">2.577</span>, sdlog <span class="op">=</span> <span class="fl">0.440</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">7L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">cfr_time_varying</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            date severity_mean severity_low severity_high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1089 2022-12-26    0.02750191   0.02324170    0.03229909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1090 2022-12-27    0.02417420   0.02025046    0.02862110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1091 2022-12-28    0.02278391   0.01904251    0.02703157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1092 2022-12-29    0.02443221   0.02061721    0.02873419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1093 2022-12-30    0.02242303   0.01882017    0.02650187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1094 2022-12-31    0.02169269   0.01818096    0.02567269</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pratik R. Gupte, Adam Kucharski, Tim Russell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

